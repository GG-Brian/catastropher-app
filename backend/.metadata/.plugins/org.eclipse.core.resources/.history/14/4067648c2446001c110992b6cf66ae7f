package com.itc.catastropher.data.service;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.itc.catastropher.data.dao.IHelpgroupDao;
import com.itc.catastropher.data.model.Disaster;
import com.itc.catastropher.data.model.Helpgroup;

@Service
public class ImplementHelpgroupService implements IHelpgroupService {

	@Autowired IHelpgroupDao groupDao;
	
	@Override
	public List<Helpgroup> getAll() {
		return (List<Helpgroup>) groupDao.findAll();
	}

	@Override
	public Optional<Helpgroup> getOne(long groupId) {
		return groupDao.findById(groupId);
	}

	@Override
	public void add(Helpgroup newGroup) {
		groupDao.save(newGroup);
	}

	@Override
	public void update(long groupId, Helpgroup changedGroup) {
		groupDao.findById(groupId).ifPresent((x) -> {
			changedGroup.setId(groupId);
			groupDao.save(changedGroup);
		});		
	}

	@Override
	public void delete(long groupId) {
		groupDao.deleteById(groupId);
	}
	
	

	@Override
	public void addDisaster(Helpgroup grupo, Optional<Disaster> d) {
		System.out.println("servicio");
		System.out.println(d.get().getId());
		System.out.println(d.get().getType());
		System.out.println(d.get().getOrigin());
		System.out.println(d.get().getArea());
		System.out.println(d.get().getInjured());
		System.out.println(d.get().getDeceased());
		System.out.println(d.get().getTime());
		System.out.println("disasters");
		System.out.println(d.get().getId());
		System.out.println(grupo.disasters.size());
		grupo.disasters.forEach((Disaster dd) -> {
			System.out.println("Todos los disaster del grupo");
			System.out.println(dd.getId());
		});
		
		System.out.println(grupo.disasters.add(d.get()));
		System.out.println(grupo.getDisasters());
		
		System.out.println("ComprobaciÃ³n");
		System.out.println(grupo.disasters.size());
		grupo.disasters.forEach((Disaster dd) -> {
			System.out.println("Todos los disaster del grupo");
			System.out.println(dd.getId());
			System.out.println(dd.getArea());
		});
	}

}